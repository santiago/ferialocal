{"ts":1352769034622,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var upload = require('../lib/Upload')();\nvar ServiceBase = require('../lib/ServiceBase');\n\nvar Mapping = require('../domain/Mapping').domain;\nvar MappingStore = require('../domain/Mapping').store;\n\nmodule.exports = function(app) {\n    this.name = 'mapping';\n    this.resource = '/mappings';\n    this.store = MappingStore;\n    \n    this.beforePost = function(req, res, next) {\n        req.body.user_id = req.session.auth.userId\n        next();\n    };\n    \n    ServiceBase.call(this, app, null);\n    \n    app.post('/mappings/:mapping_id/points/:point_id/image', upload, function(req, res) {\n        res.send('ok')\n    });\n    \n    app.post('/mappings/:mapping_id/points', this.beforePost, function(req, res) {\n        req.body.loc = [parseFloat(req.body.lat), parseFloat(req.body.lon)];\n        delete req.body['lat'];\n        delete req.body['lon'];\n\n        Mapping.addPoint(req.params.mapping_id, req.body);\n        res.send({ ok: true });\n    });\n\n    return this;\n};"]],"start1":0,"start2":0,"length1":0,"length2":969}]],"length":969}
{"contributors":[],"silentsave":false,"ts":1352769057428,"patch":[[{"diffs":[[0,");\n\nvar "],[-1,"Mapp"],[1,"Offer"],[0,"ing = re"]],"start1":87,"start2":87,"length1":20,"length2":21},{"diffs":[[0,"('../domain/"],[-1,"Mapp"],[1,"Offer"],[0,"ing').domain"]],"start1":113,"start2":113,"length1":28,"length2":29},{"diffs":[[0,"in;\nvar "],[-1,"Mapp"],[1,"Offer"],[0,"ingStore"]],"start1":140,"start2":140,"length1":20,"length2":21},{"diffs":[[0,"/domain/"],[-1,"Mapp"],[1,"Offer"],[0,"ing').st"]],"start1":175,"start2":175,"length1":20,"length2":21}]],"length":973,"saved":false}
{"ts":1352769063818,"patch":[[{"diffs":[[0,"store = "],[-1,"Mapp"],[1,"Offer"],[0,"ingStore"]],"start1":304,"start2":304,"length1":20,"length2":21}]],"length":974,"saved":false}
{"ts":1352769074347,"patch":[[{"diffs":[[0,"\n    app.post('/"],[-1,"mapp"],[1,"offer"],[0,"ings/:mapping_id"]],"start1":503,"start2":503,"length1":36,"length2":37}]],"length":975,"saved":false}
{"ts":1352769093907,"patch":[[{"diffs":[[0,"gs/:"],[-1,"mapp"],[1,"offer"],[0,"ing_id/"],[-1,"points/:point_id/"],[1,"logo_"],[0,"imag"]],"start1":526,"start2":526,"length1":36,"length2":25}]],"length":964,"saved":false}
{"ts":1352769108762,"patch":[[{"diffs":[[0,"   \n"],[-1,"    app.post('/mappings/:mapping_id/points', this.beforePost, function(req, res) {\n        req.body.loc = [parseFloat(req.body.lat), parseFloat(req.body.lon)];\n        delete req.body['lat'];\n        delete req.body['lon'];\n\n        Mapping.addPoint(req.params.mapping_id, req.body);\n        res.send({ ok: true });\n    });\n\n"],[0,"    "]],"start1":616,"start2":616,"length1":333,"length2":8}]],"length":639,"saved":false}
{"ts":1352769110424,"patch":[[{"diffs":[[0,"    });\n"],[-1,"    "],[0,"\n    ret"]],"start1":607,"start2":607,"length1":20,"length2":16}]],"length":635,"saved":false}
